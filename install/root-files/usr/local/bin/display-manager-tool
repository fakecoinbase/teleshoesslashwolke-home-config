#!/usr/bin/perl
use strict;
use warnings;

my $DISPLAY_MANAGER = "sddm";
my @CMD_START = ("systemctl", "start", $DISPLAY_MANAGER);
my @CMD_STOP = ("systemctl", "stop", $DISPLAY_MANAGER);

sub getRoot(@);

my $usage = "
  $0 --start
    start display manager:
      @CMD_START

  $0 --stop
    stop display manager:
      @CMD_STOP
";

sub main(@){
  getRoot(@_);
  if(@_ == 1 and $_[0] =~ /^(--start)$/){
    exec @CMD_START;
  }elsif(@_ == 1 and $_[0] =~ /^(--stop)$/){
    exec @CMD_STOP;
  }else{
    die $usage;
  }
}

sub getRoot(@){
  if(not `whoami` eq "root\n"){
    print "rerunning $0 as root\n";
    exec "sudo", $0, @_;
  }
}

&main(@ARGV);
